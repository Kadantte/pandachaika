(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){var n=a(95);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},12:function(e,t,a){var n=a(94);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},17:function(e,t,a){var n=a(97);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},39:function(e,t,a){var n=a(78);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},47:function(e,t,a){var n=a(93);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},48:function(e,t,a){e.exports=a.p+"static/media/no_cover.8e25d57e.png"},49:function(e,t,a){var n=a(96);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},51:function(e,t,a){e.exports=a(98)},56:function(e,t,a){},57:function(e,t,a){},7:function(e,t,a){var n=a(89);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(15)(n,i);n.locals&&(e.exports=n.locals)},78:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,".NavigationPager__midItem___1cqZa {\n  padding: 0.25rem 0.75rem;\n  line-height: 1.25;\n  color: #ddd;\n  background-color: #0e1339;\n  border: 1px solid #dee2e6; }\n",""]),t.locals={midItem:"NavigationPager__midItem___1cqZa"}},89:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,".ImageViewer__inlineBlock___3x7PU {\n  display: inline-block;\n  width: 55px; }\n\n/* Overlays */\n.ImageViewer__overlay___jS0Z0 {\n  position: absolute;\n  max-width: 100%;\n  height: 20px;\n  z-index: 10;\n  color: antiquewhite;\n  background-color: rgba(0, 0, 0, 0.5);\n  /* dim the background */\n  top: 1rem;\n  text-align: center; }\n\n.ImageViewer__overlayTop___2AckZ {\n  top: 0;\n  left: 95%;\n  text-align: center; }\n\n.ImageViewer__overlayRight___2JUTP {\n  left: 85%;\n  text-align: center; }\n\n.ImageViewer__hide___1aBrC {\n  display: none; }\n\n.ImageViewer__overlayLeft___38-fE {\n  left: 1%;\n  text-align: left; }\n\n.ImageViewer__imgContainer___3vJ9G {\n  position: relative; }\n\n.ImageViewer__imgContainer___3vJ9G:-ms-fullscreen > .ImageViewer__overlay___jS0Z0 {\n  display: inherit;\n  top: 2%; }\n\n.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen > .ImageViewer__overlay___jS0Z0 {\n  display: inherit;\n  top: 2%; }\n\n.ImageViewer__imgContainer___3vJ9G:-moz-full-screen > .ImageViewer__overlay___jS0Z0 {\n  display: inherit;\n  top: 2%; }\n\n/* Fullscreen adjustments */\nimg.ImageViewer__active___1FrCT {\n  /* width: auto; */\n  max-height: 100%;\n  margin-left: auto;\n  margin-right: auto;\n  height: auto;\n  max-width: 100%;\n  -webkit-transition-property: -webkit-transform;\n  transition-property: transform, -webkit-transform;\n  -webkit-transition-duration: 0.2s;\n  -o-transition-duration: 0.2s;\n     transition-duration: 0.2s;\n  -webkit-transition-timing-function: ease-out;\n  -o-transition-timing-function: ease-out;\n     transition-timing-function: ease-out; }\n\n.ImageViewer__imgContainer___3vJ9G:-ms-fullscreen > .ImageViewer__active___1FrCT {\n  width: auto;\n  max-height: 100%; }\n\n.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen {\n  width: 100%;\n  height: 100%;\n  background-color: black; }\n\n.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen > .ImageViewer__active___1FrCT {\n  width: auto; }\n\n.ImageViewer__imgContainer___3vJ9G:-moz-full-screen > .ImageViewer__active___1FrCT {\n  width: auto;\n  max-height: 100%; }\n\n.ImageViewer__modalContainer___1MxZ7 {\n  position: absolute;\n  height: 100px;\n  width: 95%; }\n\n.ImageViewer__tag___2mHoz {\n  background-color: rgba(0, 0, 0, 0.5);\n  /* dim the background */\n  display: table; }\n\n.ImageViewer__HotKeys___2ICLN:focus {\n  outline: 0; }\n\n.ImageViewer__centerText___1e3gu {\n  text-align: center; }\n",""]),t.locals={inlineBlock:"ImageViewer__inlineBlock___3x7PU",overlay:"ImageViewer__overlay___jS0Z0",overlayTop:"ImageViewer__overlayTop___2AckZ",overlayRight:"ImageViewer__overlayRight___2JUTP",hide:"ImageViewer__hide___1aBrC",overlayLeft:"ImageViewer__overlayLeft___38-fE",imgContainer:"ImageViewer__imgContainer___3vJ9G",active:"ImageViewer__active___1FrCT",modalContainer:"ImageViewer__modalContainer___1MxZ7",tag:"ImageViewer__tag___2mHoz",HotKeys:"ImageViewer__HotKeys___2ICLN",centerText:"ImageViewer__centerText___1e3gu"}},9:function(e,t){e.exports={basename:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_PB_HOST_URL||"/new-image-viewer",PandaBackupUrl:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_PB_SERVER||"/r-api",PandaBackupKey:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_PB_KEY||""}},93:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,".Archive__container___3L_dg {\n  margin: 0 auto;\n  padding: 0;\n  text-align: center; }\n",""]),t.locals={container:"Archive__container___3L_dg"}},94:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,".Help__verticalCenter___2hUR- {\n  -ms-flex-align: center;\n  align-items: center; }\n\n.Help__flex___2JJlN {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-flow: row wrap;\n  flex-flow: row wrap;\n  list-style: none;\n  background: rgba(0, 0, 0, 0.9); }\n\n.Help__flex___2JJlN > * {\n  -ms-flex: 0 1 auto;\n  flex: 0 1 auto;\n  max-width: 100%;\n  text-align: start; }\n\n.Help__grow___4mrVI {\n  -ms-flex-positive: 1;\n  flex-grow: 1;\n  color: #b8b5c0; }\n\n.Help__noGrow___34bmx {\n  -ms-flex-positive: 0;\n  flex-grow: 0;\n  color: lightblue; }\n\n.Help__fullWidth___T7Iuq {\n  width: 100%; }\n",""]),t.locals={verticalCenter:"Help__verticalCenter___2hUR-",flex:"Help__flex___2JJlN",grow:"Help__grow___4mrVI",noGrow:"Help__noGrow___34bmx",fullWidth:"Help__fullWidth___T7Iuq"}},95:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,"/**\r\n * Common application sass variables and mixins.\r\n * Import in Component.scss file to use app & bootstrap variables.\r\n */\n/**\r\n * Use this file to define application variables and override bootstrap variables.\r\n * For an example of using bootstrap variables see ContactPage.scss\r\n */\n/*\r\n * Typography\r\n * ========================================================================== */\n/*\r\n * Layout\r\n * ========================================================================== */\n/*\r\n * Misc\r\n * ========================================================================== */\n/**\r\n * Custom application mixins available through out the app\r\n */\n.ArchiveCover__gallery___2XNvD {\n  display: inline-block;\n  vertical-align: top;\n  text-align: center;\n  background: #001a4c;\n  font-weight: bold;\n  position: relative;\n  width: 100%;\n  border: 1px solid grey;\n  border-radius: 2px; }\n\n.ArchiveCover__gallery___2XNvD,\na:hover {\n  color: inherit;\n  text-decoration: none; }\n\n.ArchiveCover__coverTitle___3MvdX {\n  /* background-color: #FFF; */\n  max-height: 28px;\n  line-height: 13px;\n  padding: 3px;\n  overflow: hidden;\n  width: 100%;\n  height: 4em;\n  font-size: 0.85em; }\n\n.ArchiveCover__extracted___2UiVm > a > .ArchiveCover__coverTitle___3MvdX {\n  color: #00d0ff; }\n\n.ArchiveCover__caption___1jseu {\n  /* background-color: #FFF; */\n  max-height: 35px;\n  line-height: 15px;\n  padding: 3px;\n  overflow: hidden;\n  width: 100%;\n  z-index: 10;\n  font-size: 0.85em;\n  color: #a8a8a4; }\n\n.ArchiveCover__imageContainer___C1fJ3 {\n  display: block;\n  max-width: 100%;\n  height: auto;\n  margin-left: auto;\n  margin-right: auto; }\n\n.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU {\n  /* Chrome10-25,Safari5.1-6 */\n  background: rgba(0, 0, 0, 0.75);\n  position: absolute;\n  bottom: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  margin-top: 28px;\n  margin-bottom: 21px;\n  height: auto;\n  width: 100%;\n  pointer-events: none;\n  opacity: 0;\n  -webkit-transition: opacity 0.125s ease;\n  -o-transition: opacity 0.125s ease;\n  transition: opacity 0.125s ease; }\n\n.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno {\n  width: 100%;\n  height: 100%;\n  font-size: 14px;\n  font-weight: 300;\n  line-height: 1.05;\n  opacity: 0;\n  -webkit-line-clamp: 3;\n  overflow: hidden;\n  -o-text-overflow: ellipsis;\n     text-overflow: ellipsis;\n  -webkit-transition: margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s;\n  -o-transition: margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s;\n  transition: margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s; }\n\n.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno .ArchiveCover__tag___jOY9w {\n  width: 100%;\n  cursor: pointer; }\n\n.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU {\n  opacity: 1;\n  pointer-events: all; }\n\n.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno {\n  opacity: 1; }\n\n.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU .ArchiveCover__ListToggle___3cs9R {\n  opacity: 1; }\n\n.ArchiveCover__queryTag___3IBHh {\n  color: lightgreen; }\n\n.ArchiveCover__smallButton___2ZAiq {\n  margin: 2px; }\n",""]),t.locals={gallery:"ArchiveCover__gallery___2XNvD",coverTitle:"ArchiveCover__coverTitle___3MvdX",extracted:"ArchiveCover__extracted___2UiVm",caption:"ArchiveCover__caption___1jseu",imageContainer:"ArchiveCover__imageContainer___C1fJ3",overlay:"ArchiveCover__overlay___1wIAU",tags:"ArchiveCover__tags___GLbno",tag:"ArchiveCover__tag___jOY9w",ListToggle:"ArchiveCover__ListToggle___3cs9R",queryTag:"ArchiveCover__queryTag___3IBHh",smallButton:"ArchiveCover__smallButton___2ZAiq"}},96:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,"@media screen and (min-width: 1456px) {\n  .SidebarArchives__archCont___30IUp {\n    width: 12%; } }\n\n@media screen and (max-width: 1455px) {\n  .SidebarArchives__archCont___30IUp {\n    width: 19%; } }\n\n@media screen and (max-width: 1019px) {\n  .SidebarArchives__archCont___30IUp {\n    width: 24%; } }\n\n@media screen and (max-width: 814px) {\n  .SidebarArchives__archCont___30IUp {\n    width: 32%; } }\n\n@media screen and (max-width: 542px) {\n  .SidebarArchives__archCont___30IUp {\n    width: 49%; } }\n\n@media screen and (max-width: 300px) {\n  .SidebarArchives__archCont___30IUp {\n    width: 100%; } }\n",""]),t.locals={archCont:"SidebarArchives__archCont___30IUp"}},97:function(e,t,a){(t=e.exports=a(14)(!1)).push([e.i,".Home__inlineBlock___33Dcx {\n  display: inline-block;\n  width: 55px; }\n\n.Home__container___KkeO7 {\n  position: relative; }\n\n/* Overlays */\n.Home__overlay___1L6jf {\n  position: absolute;\n  max-width: 100%;\n  height: 20px;\n  z-index: 10;\n  color: antiquewhite;\n  background-color: rgba(0, 0, 0, 0.5);\n  /* dim the background */\n  top: 1rem;\n  text-align: center; }\n\n.Home__overlayTop___1g6qW {\n  top: 0;\n  left: 95%;\n  text-align: center; }\n\n.Home__overlayHelp___1USgm {\n  position: absolute;\n  left: 85%; }\n\n.Home__overlayRight___AiZmH {\n  position: absolute;\n  right: 1%;\n  top: 0;\n  z-index: 5; }\n\n.Home__overlayLeft___JWQEH {\n  position: absolute;\n  left: 1%;\n  z-index: 5; }\n\n.Home__imgContainer___3M7tW {\n  position: relative; }\n\n.Home__imgContainer___3M7tW:-ms-fullscreen > .Home__overlay___1L6jf {\n  display: inherit;\n  top: 2%; }\n\n.Home__imgContainer___3M7tW:-webkit-full-screen > .Home__overlay___1L6jf {\n  display: inherit;\n  top: 2%; }\n\n.Home__imgContainer___3M7tW:-moz-full-screen > .Home__overlay___1L6jf {\n  display: inherit;\n  top: 2%; }\n\n/* Fullscreen adjustments */\nimg.Home__active___2X6FD {\n  /* width: auto; */\n  max-height: 100%;\n  margin-left: auto;\n  margin-right: auto;\n  height: auto;\n  max-width: 100%; }\n\n.Home__imgContainer___3M7tW:-ms-fullscreen > .Home__active___2X6FD {\n  width: auto;\n  max-height: 100%; }\n\n.Home__imgContainer___3M7tW:-webkit-full-screen {\n  width: 100%;\n  max-height: 100%;\n  background-color: black; }\n\n.Home__imgContainer___3M7tW:-webkit-full-screen > .Home__active___2X6FD {\n  max-height: 100%; }\n\n.Home__imgContainer___3M7tW:-moz-full-screen > .Home__active___2X6FD {\n  width: auto;\n  max-height: 100%; }\n\n.Home__modalContainer___DzRT5 {\n  position: absolute;\n  height: 100px;\n  width: 95%; }\n\n.Home__tag___30qLH {\n  background-color: rgba(0, 0, 0, 0.5);\n  /* dim the background */\n  display: table; }\n\n.Home__HotKeys___3qY1w:focus {\n  outline: 0; }\n",""]),t.locals={inlineBlock:"Home__inlineBlock___33Dcx",container:"Home__container___KkeO7",overlay:"Home__overlay___1L6jf",overlayTop:"Home__overlayTop___1g6qW",overlayHelp:"Home__overlayHelp___1USgm",overlayRight:"Home__overlayRight___AiZmH",overlayLeft:"Home__overlayLeft___JWQEH",imgContainer:"Home__imgContainer___3M7tW",active:"Home__active___2X6FD",modalContainer:"Home__modalContainer___DzRT5",tag:"Home__tag___30qLH",HotKeys:"Home__HotKeys___3qY1w"}},98:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),o=a(6),r=a.n(o),s=(a(56),a(57),a(101)),l=a(100),c=a(102),h=a(21),_=a(2),d=a.n(_),m=a(38),g=a.n(m),u=a(24),p=a(16),v=a.n(p),y=a(4),f=a(39),C=a.n(f);var w=({className:e,currentPosition:t,lastPosition:a,navSelectOptions:n,handleChange:o,moveLeft:r,moveFirst:s,moveRight:l,moveLast:c})=>i.a.createElement(y.b,{listClassName:"justify-content-center my-0"},i.a.createElement(y.c,null,i.a.createElement(y.d,{onClick:s},"\u2190\u2190")),i.a.createElement(y.c,null,i.a.createElement(y.d,{onClick:r},"\u2190")),i.a.createElement(y.c,null,i.a.createElement("div",{className:C.a.midItem},i.a.createElement(u.a,{className:e,name:"select-page",value:{value:t},onChange:o,options:n,clearable:!1,autoBlur:!0,noResultsText:"No valid page"}),i.a.createElement("span",{style:{verticalAlign:"super"}},` of ${a} `))),i.a.createElement(y.c,null,i.a.createElement(y.d,{onClick:l},"\u2192")),i.a.createElement(y.c,null,i.a.createElement(y.d,{onClick:c},"\u2192\u2192")));var b=({images:e})=>i.a.createElement("div",{style:{position:"absolute",left:"85%",top:"16%",width:"15%"}},Object.keys(e).map(t=>{const a=e[Number(t)].percent;switch(e[Number(t)].state){case"progress":return i.a.createElement(y.e,{key:t,color:a<0?"warning":"success",value:a},`${t}: ${a}%`);case"load":return i.a.createElement(y.e,{key:t,color:"info",value:a},`${t}: ${a}%`);case"error":case"abort":return i.a.createElement(y.e,{key:t,color:"danger",value:a},`${t}: ${a}%`);default:return i.a.createElement(y.e,{key:t,color:"info",value:a},`${t}: ${a}%`)}})),I=a(7),x=a.n(I),k=a(44),P=a.n(k),E=a(9),N=a.n(E);async function H(e,t){const a=t||1;let n;n=""===N.a.PandaBackupKey?"":`&api_key=${N.a.PandaBackupKey}`;const i=`${N.a.PandaBackupUrl}/archive/${e}/?position=${a}${n}`,o=await fetch(i,{credentials:"include"});return await o.json()}async function S(e){let t;t=""===e?`?api_key=${N.a.PandaBackupKey}`:`&api_key=${N.a.PandaBackupKey}`;const a=`${N.a.PandaBackupUrl}/archives/${e}${t}`,n=await fetch(a,{credentials:"include"});return await n.json()}function A(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function M(e,t,a,n){let i=e-n,o=e+n;return i<t&&(i=t),o>a&&(o=a),[new Array(e-i).fill(0).map((t,a)=>e-a-1),new Array(o-e).fill(0).map((t,a)=>a+e+1)]}function F(e,t){const a=t[0].length+t[1].length;let n=[];for(let i=0;i<a;i++)for(let e=0;e<2;e++)t[e].length-1<i||n.push(t[e][i]);return[e,...n]}function T(e,t,a,n,i){let o=0,r=0;return a?e>=n?r=(o=n)*e/t:(o=e,r=t):e>=i?r=(o=i)*e/t:(o=e,r=t),[o,r]}var L=Object(c.a)(class extends n.Component{constructor(e){super(e),A(this,"node",void 0),A(this,"imgContainer",void 0),A(this,"modalInput",void 0),A(this,"slider",void 0),A(this,"updateProgress",e=>{e.lengthComputable?this.setState({images:v()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{percent:e.loaded/e.total}}})}):this.setState({images:v()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{percent:-1}}})})}),A(this,"transferComplete",e=>{this.setState({images:v()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{percent:100,state:"load"}}})})}),A(this,"transferFailed",e=>{this.setState({images:v()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{state:"error"}}})})}),A(this,"transferCanceled",e=>{this.setState({images:v()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{state:"abort"}}})})}),A(this,"getImagesData",e=>{e.filter(e=>!{}.hasOwnProperty.call(this.state.images,e.position)).forEach(e=>{const t=new window.Image;t.id=e.position.toString(),t.addEventListener("progress",this.updateProgress),t.addEventListener("load",this.transferComplete),t.addEventListener("error",this.transferFailed),t.addEventListener("abort",this.transferCanceled),t.src=e.url,this.setState({images:v()(this.state.images,{[e.position]:{$set:{position:e.position,url:e.url,width:e.width,height:e.height,is_horizontal:e.is_horizontal,state:"progress",percent:0}}})})})}),A(this,"getNonCachedImagesUrls",(e,t)=>{const a=t.filter(e=>!{}.hasOwnProperty.call(this.state.images,e));0!==a.length&&async function(e,t){const a=P.a.stringify({i:t},{indices:!1});let n;n=""===N.a.PandaBackupKey?"":`&api_key=${N.a.PandaBackupKey}`;const i=`${N.a.PandaBackupUrl}/archive/${e}/image_list/?${a}${n}`,o=await fetch(i,{credentials:"include"});return await o.json()}(e,a).then(e=>this.getImagesData(e))}),A(this,"goToPosition",e=>{e!==this.state.currentPosition&&this.props.history.replace(`/${this.props.archive.id}/img/${e}${this.props.location.search}`)}),A(this,"handleImgClick",e=>{!function(e){const t=e.currentTarget;let a=0,n=t;for(;n;)a+=n.offsetLeft,n=n.offsetParent;return t.style.paddingLeft&&(a+=Number(t.style.paddingLeft.match(/\d+/)[0])),a-=window.scrollX,(e.clientX-a)/(t.width||t.offsetWidth)>.5}(e)?this.moveLeft():this.moveRight()}),A(this,"handleSliderChange",e=>{this.goToPosition(e+1)}),A(this,"moveLeft",()=>{this.props.doublePageMode&&this.state.navImages[0].length>1?this.handlePositionChanges(this.state.navImages[0][1]):this.state.navImages[0].length>0&&this.handlePositionChanges(this.state.navImages[0][0])}),A(this,"moveRight",()=>{this.props.doublePageMode&&this.state.navImages[1].length>1?this.handlePositionChanges(this.state.navImages[1][1]):this.state.navImages[1].length>0&&this.handlePositionChanges(this.state.navImages[1][0])}),A(this,"moveFirst",()=>{this.handlePositionChanges(this.props.startPosition)}),A(this,"moveLast",()=>{this.handlePositionChanges(this.props.archive.lastPosition)}),A(this,"handlePositionModalGoTo",e=>{this.handlePositionChanges(e.value)}),A(this,"handlePositionChanges",e=>{this.goToPosition(e),this.props.displayCovers&&this.slider.slickGoTo(e-1)}),A(this,"togglePositionModal",()=>{this.setState({showPositionModal:!this.state.showPositionModal}),this.state.showPositionModal&&this.modalInput&&this.modalInput.current&&this.modalInput.current.focus()}),A(this,"correctWith",e=>e.is_horizontal?e.width>=this.state.horizontal?this.state.horizontal:e.width:e.width>=this.state.vertical?this.state.vertical:e.width),A(this,"keyHandlers",{moveLeft:this.moveLeft,moveRight:this.moveRight,moveFirst:this.moveFirst,moveLast:this.moveLast,previousQueue:()=>this.props.handleQueueChange(this.props.archive.id,-1),nextQueue:()=>this.props.handleQueueChange(this.props.archive.id,1),togglePositionModal:e=>{this.togglePositionModal(),e.preventDefault()}}),this.modalInput=i.a.createRef();const t={};if(e.archive.startImage){const[a,n]=T(e.archive.startImage.width,e.archive.startImage.height,e.archive.startImage.is_horizontal,1500,900);e.archive.startImage&&(t[e.startIndex]={position:e.startIndex,url:e.archive.startImage.url,width:a,height:n,is_horizontal:e.archive.startImage.is_horizontal,state:"load",percent:100})}this.state={currentArchiveId:e.archive.id,currentPosition:e.startIndex,positionModal:e.startIndex,horizontal:1500,vertical:900,showPositionModal:!1,loading:!0,navImages:M(e.startIndex,e.startPosition,e.archive.lastPosition,5),images:t}}componentDidMount(){this.getNonCachedImagesUrls(this.props.archive.id,F(this.state.currentPosition,[this.state.navImages[1],this.state.navImages[0]])),this.node&&this.node.scrollIntoView(),this.props.displayCovers&&this.slider.slickGoTo(this.state.currentPosition-1),this.props.setCurrentContainer(this.imgContainer)}static getDerivedStateFromProps(e,t){let a=e.archive.id,n=t.currentArchiveId,i=e.startIndex,o=t.currentPosition;if(a!==n){const n={};if(e.archive.startImage){const[a,i]=T(e.archive.startImage.width,e.archive.startImage.height,e.archive.startImage.is_horizontal,t.horizontal,t.vertical);e.archive.startImage&&(n[e.startIndex]={position:e.startIndex,url:e.archive.startImage.url,width:a,height:i,is_horizontal:e.archive.startImage.is_horizontal,state:"load",percent:100})}return{currentArchiveId:a,currentPosition:e.startIndex,positionModal:e.startIndex,loading:!0,navImages:M(e.startIndex,e.startPosition,e.archive.lastPosition,5),images:n}}return i!==o?{loading:!0,navImages:M(i,e.startPosition,e.archive.lastPosition,5),currentPosition:i,positionModal:i}:null}componentDidUpdate(e){console.log("did update");let t=this.props.archive.id,a=e.archive.id,n=this.props.startIndex,i=e.startIndex;t===a&&n===i||(this.getNonCachedImagesUrls(t,F(this.state.currentPosition,[this.state.navImages[1],this.state.navImages[0]])),this.imgContainer&&this.imgContainer.scrollIntoView()),this.props.displayCovers&&this.slider.slickGoTo(this.state.currentPosition-1)}componentWillUnmount(){this.props.setCurrentContainer(null)}render(){const{showPositionModal:e,currentPosition:t,images:a}=this.state,{displayCovers:n,displayNavigators:o,displayMetadata:r,autoWidth:s,displayPreloadInfo:l,doublePageMode:c,scale:_}=this.props,{lastPosition:m}=this.props.archive,p=r&&i.a.createElement("div",{className:d()(x.a.overlay,x.a.overlayLeft)},i.a.createElement("div",{className:x.a.tag},this.props.archive.title),this.props.archive.tags.map(e=>i.a.createElement("div",{className:x.a.tag,key:e},`${e}`))),v={transform:`scaleX(${_}) scaleY(${_})`,transformOrigin:"center top"},y=[];c&&t<m&&a[t+1]&&y.push(i.a.createElement("img",{key:a[t+1].url,className:x.a.active,src:a[t+1].url,alt:"",width:s?"auto":this.correctWith(a[t+1]),height:a[t+1].height,style:v})),a[t]&&y.push(i.a.createElement("img",{key:a[t].url,className:x.a.active,src:a[t].url,alt:"",width:s?"auto":this.correctWith(a[t]),height:a[t].height,style:v}));const f=n&&new Array(m).fill(0).map((e,t)=>!{}.hasOwnProperty.call(a,t+1)?i.a.createElement("div",{key:String(t+1),style:{width:210,height:285}},i.a.createElement("h3",null,"Not loaded")):i.a.createElement("div",{key:a[t+1].url,style:{width:210,height:285}},i.a.createElement("img",{className:"img-fluid mx-auto",src:a[t+1].url,alt:"",width:200,height:"auto"}))),C=new Array(m).fill(0).map((e,t)=>({value:t+1,label:t+1})),I=e&&i.a.createElement("div",{className:x.a.modalContainer},i.a.createElement(u.a,{className:x.a.inlineBlock,name:"select-page-fast",value:{value:t},onChange:this.handlePositionModalGoTo,options:C,clearable:!1,autoBlur:!0,openOnFocus:!0,onClose:this.togglePositionModal,noResultsText:"No valid page",ref:this.modalInput})),k=l&&i.a.createElement(b,{images:a});return i.a.createElement(h.HotKeys,{className:x.a.HotKeys,focused:!0,attach:window,handlers:this.keyHandlers},i.a.createElement("div",{ref:e=>this.node=e},i.a.createElement("h6",null,this.props.archive.title),n&&i.a.createElement(g.a,{className:x.a.container,dots:!1,infinite:!1,speed:0,slidesToShow:3,slidesToScroll:1,focusOnSelect:!0,centerMode:!0,centerPadding:"0",ref:e=>{this.slider=e},variableWidth:!0,initialSlide:this.props.startIndex-1,afterChange:this.handleSliderChange},f),o&&i.a.createElement(w,{className:x.a.inlineBlock,currentPosition:t,lastPosition:m,moveFirst:this.moveFirst,moveLeft:this.moveLeft,moveRight:this.moveRight,moveLast:this.moveLast,handleChange:this.handlePositionModalGoTo,navSelectOptions:C}),k,i.a.createElement("div",{id:"img-display",className:x.a.imgContainer,onClick:this.handleImgClick,ref:e=>this.imgContainer=e},I,a[t]?y:i.a.createElement("h5",null,"Archive needs to be extracted before using it in here."),i.a.createElement("div",{className:d()(x.a.overlay,x.a.overlayTop,x.a.hide)},i.a.createElement("span",{id:"img-counter"},t),"/",m),p)))}}),V=a(47),R=a.n(V);var U=class extends n.Component{constructor(...e){var t,a,n;super(...e),n={archive:null},(a="state")in(t=this)?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n}componentDidMount(){H(this.props.match.params.archiveId,Number(this.props.match.params.imgId)).then(e=>{this.setState({archive:e}),document.title=e.title})}componentDidUpdate(e){const t=e.match.params.archiveId,a=this.props.match.params.archiveId,n=this.props.match.params.imgId;a!==t&&H(a,Number(n)).then(e=>{this.setState({archive:e}),document.title=e.title})}render(){const{archive:e}=this.state,{match:t,handleQueueChange:a,displayCovers:n,displayNavigators:o,displayMetadata:r,autoWidth:s,displayPreloadInfo:l,doublePageMode:c,setCurrentContainer:h,scale:_}=this.props;return i.a.createElement("div",{className:R.a.container},e?i.a.createElement(L,{startIndex:Number(t.params.imgId),archive:e,startPosition:1,handleQueueChange:a,displayCovers:n,displayNavigators:o,displayMetadata:r,displayPreloadInfo:l,doublePageMode:c,setCurrentContainer:h,autoWidth:s,scale:_}):null)}},$=a(12),z=a.n($);var j=({actions:e})=>i.a.createElement("div",{className:z.a.flex},i.a.createElement("div",{className:d()(z.a.verticalCenter,z.a.fullWidth)},"Keyboard shortcuts"),e.map(e=>i.a.createElement("div",{className:d()(z.a.verticalCenter,z.a.flex,z.a.fullWidth),key:e.key},i.a.createElement("div",{className:d()(z.a.grow)},e.description),i.a.createElement("div",{className:d()(z.a.noGrow)},e.key)))),D=a(99),B=a(10),W=a.n(B);const O=({src:e,title:t,height:a,width:n,className:o})=>{const r={maxHeight:290,width:n},s={height:"auto",maxWidth:"100%",maxHeight:a,border:"1px solid #ccc"};return i.a.createElement("div",{className:o,style:{...r}},i.a.createElement("img",{style:s,src:e,alt:t,height:a,width:n}))};O.defaultProps={width:200,height:290};var q=O,Q=a(48),G=a.n(Q);var J=Object(c.a)(({archive:e,location:t})=>{const a=e.image?e.image:G.a,n=e.tags.map(e=>i.a.createElement("div",{className:W.a.tag,key:e},`${e}`));return i.a.createElement("div",{className:d()(W.a.gallery,e.extracted?W.a.extracted:null)},i.a.createElement(D.a,{to:`/${e.id}/img/1${t.search}`},i.a.createElement("div",{className:W.a.coverTitle,title:e.title},e.title),i.a.createElement(q,{className:W.a.imageContainer,src:a,title:e.title,width:e.image_width,height:e.image_height}),i.a.createElement("div",{className:W.a.overlay},i.a.createElement("div",{className:W.a.tags},n))),i.a.createElement("div",null,i.a.createElement("div",{className:W.a.caption},`${e.filecount} | `,i.a.createElement("a",{className:d()(W.a.link,W.a.highlight),href:`${e.url}`},"SRC"))))});const K={position:"absolute",top:"0px"};var X=({onClick:e,showContent:t,alignRight:a})=>{let n;const o=a?">":"<",r=a?"<":">";return n=t?Object.assign({},K,a?{left:"-30px"}:{right:"-30px"}):Object.assign({},K,a?{right:"0"}:{left:"0"}),i.a.createElement(y.a,{onClick:e,size:"sm",style:n},t?o:r)},Z=a(49),Y=a.n(Z);var ee=({displayQueue:e,archives:t,toggleQueue:a,className:n})=>i.a.createElement("div",{className:d()(n,e?Y.a.archCont:null)},e?t.objects.map(e=>i.a.createElement("div",{key:e.id},i.a.createElement(J,{archive:e}))):null,i.a.createElement(X,{onClick:a,showContent:e,alignRight:!1}));var te=({displayControls:e,toggleControls:t,className:a,controls:n})=>i.a.createElement("div",{className:a},i.a.createElement("div",null,e?n.map(e=>i.a.createElement("div",{key:e.key},i.a.createElement(y.a,{onClick:e.action,color:"primary",size:"sm",block:!0},e.description))):null,i.a.createElement(X,{onClick:t,showContent:e,alignRight:!0}))),ae=a(17),ne=a.n(ae);function ie(){return(ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var re=Object(c.a)(class extends n.Component{constructor(...e){super(...e),oe(this,"state",{archives:null,displayQueue:!1,displayHelp:!1,displayControls:!1,currentArchive:null,displayCovers:!1,displayNavigators:!0,displayMetadata:!1,displayPreloadInfo:!1,doublePageMode:!1,autoWidth:!1,scale:1,currentContainer:null}),oe(this,"toggleFullSize",()=>{this.setState({autoWidth:!this.state.autoWidth})}),oe(this,"toggleMetadata",()=>{this.setState({displayMetadata:!this.state.displayMetadata})}),oe(this,"toggleDoublePageMode",()=>{this.setState({doublePageMode:!this.state.doublePageMode})}),oe(this,"decreaseScale",()=>{this.setState({scale:this.state.scale-.1})}),oe(this,"increaseScale",()=>{this.setState({scale:this.state.scale+.1})}),oe(this,"resetScale",()=>{this.setState({scale:1})}),oe(this,"togglePreloadInfo",()=>{this.setState({displayPreloadInfo:!this.state.displayPreloadInfo})}),oe(this,"toggleHelp",()=>{this.setState({displayHelp:!this.state.displayHelp})}),oe(this,"toggleCovers",()=>{this.setState({displayCovers:!this.state.displayCovers})}),oe(this,"toggleQueue",()=>{this.setState({displayQueue:!this.state.displayQueue})}),oe(this,"toggleControls",()=>{this.setState({displayControls:!this.state.displayControls})}),oe(this,"setCurrentContainer",e=>{this.setState({currentContainer:e})}),oe(this,"contentFullScreen",()=>{if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this.state.currentContainer;e&&(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())}}),oe(this,"actions",[{key:"left",name:"moveLeft",description:"Move Left"},{key:"right",name:"moveRight",description:"Move Right"},{key:"shift+left",name:"moveFirst",description:"Move First"},{key:"shift+right",name:"moveLast",description:"Move Last"},{key:"y",name:"previousQueue",description:"Previous in queue"},{key:"i",name:"nextQueue",description:"Next in queue"},{key:"h",name:"toggleHelp",description:"Toggle help"},{key:"p",name:"toggleQueue",description:"Toggle queue"},{key:"l",name:"toggleControls",description:"Toggle controls"},{key:"-",name:"decreaseScale",description:"Decrease Scale",action:this.decreaseScale},{key:"+",name:"increaseScale",description:"Increase Scale",action:this.increaseScale},{key:"=",name:"resetScale",description:"Reset Scale",action:this.resetScale},{key:"g",name:"toggleFullSize",description:"Full Size",action:this.toggleFullSize},{key:"f",name:"toggleFullScreen",description:"Full Screen",action:this.contentFullScreen},{key:"c",name:"toggleCovers",description:"Covers"},{key:"t",name:"toggleDoublePageMode",description:"Double page mode",action:this.toggleDoublePageMode},{key:"u",name:"togglePositionModal",description:"Position Modal"},{key:"j",name:"toggleMetadata",description:"Metadata",action:this.toggleMetadata},{key:"shift+j",name:"togglePreloadInfo",description:"Preload Info",action:this.togglePreloadInfo}]),oe(this,"keyHandlers",{togglePreloadInfo:this.togglePreloadInfo,decreaseScale:this.decreaseScale,increaseScale:this.increaseScale,resetScale:this.resetScale,toggleFullSize:this.toggleFullSize,toggleCovers:this.toggleCovers,toggleDoublePageMode:this.toggleDoublePageMode,toggleHelp:this.toggleHelp,toggleMetadata:this.toggleMetadata,toggleQueue:this.toggleQueue,toggleControls:this.toggleControls,toggleFullScreen:this.contentFullScreen}),oe(this,"handleQueueChange",(e,t)=>{if(this.state.archives){const a=this.state.archives.objects.findIndex(t=>t.id===e);if(a>-1&&this.state.archives){const e=a+t;e>=0&&e<this.state.archives.objects.length&&this.props.history.push(`/${this.state.archives.objects[e].id}/img/1${this.props.location.search}`)}}})}componentDidMount(){S(this.props.location.search).then(e=>{this.setState({archives:e})})}componentDidUpdate(e){let t=e.location.search,a=this.props.location.search;a!==t&&S(a).then(e=>{this.setState({archives:e})})}componentWillUnmount(){}render(){const{archives:e,displayQueue:t,displayHelp:a,displayCovers:n,displayNavigators:o,displayMetadata:r,autoWidth:s,displayPreloadInfo:c,doublePageMode:_,displayControls:m,scale:g}=this.state,{match:u}=this.props;return i.a.createElement(h.HotKeys,{className:ne.a.HotKeys,focused:!0,attach:window,keyMap:this.actions.reduce((e,t)=>(e[t.name]=t.key,e),{}),handlers:this.keyHandlers},i.a.createElement("div",null,i.a.createElement("div",{className:ne.a.container},e?i.a.createElement(ee,{className:ne.a.overlayLeft,archives:e,displayQueue:t,toggleQueue:this.toggleQueue}):null,i.a.createElement("div",{style:{position:"relative"}},i.a.createElement(l.a,{path:`${u.url}:archiveId/img/:imgId`,render:e=>i.a.createElement(U,ie({handleQueueChange:this.handleQueueChange,displayCovers:n,displayNavigators:o,displayMetadata:r,displayPreloadInfo:c,doublePageMode:_,setCurrentContainer:this.setCurrentContainer,autoWidth:s,scale:g},e))})),a&&i.a.createElement("div",{className:d()(ne.a.overlay,ne.a.overlayHelp)},i.a.createElement(j,{actions:this.actions})),i.a.createElement(te,{className:ne.a.overlayRight,displayControls:m,toggleControls:this.toggleControls,controls:this.actions.filter(e=>void 0!==e.action)}))))}});var se=()=>i.a.createElement(s.a,{basename:N.a.basename},i.a.createElement(l.a,{path:"/",component:re}));const le=document.getElementById("root");null!==le&&r.a.render(i.a.createElement(se,null),le)}},[[51,1,2]]]);
//# sourceMappingURL=main.9b3ed32c.chunk.js.map
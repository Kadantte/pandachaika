(this.webpackJsonpimageviewer=this.webpackJsonpimageviewer||[]).push([[0],{11:function(e,t,a){var i=a(13),o=a(72);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},16:function(e,t,a){var i=a(13),o=a(75);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},33:function(e,t,a){var i=a(13),o=a(65);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},37:function(e,t,a){var i=a(13),o=a(71);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},38:function(e,t,a){var i=a(13),o=a(74);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},39:function(e,t,a){e.exports=a(76)},4:function(e,t,a){var i=a(13),o=a(66);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},44:function(e,t,a){},45:function(e,t,a){},65:function(e,t,a){(t=a(14)(!1)).push([e.i,".NavigationPager__midItem___1cqZa{padding:0.25rem 0.75rem;line-height:1.25;color:#ddd;background-color:#0e1339;border:1px solid #dee2e6}\n",""]),t.locals={midItem:"NavigationPager__midItem___1cqZa"},e.exports=t},66:function(e,t,a){(t=a(14)(!1)).push([e.i,".ImageViewer__inlineBlock___3x7PU{display:inline-block;width:75px}.ImageViewer__overlay___jS0Z0{position:absolute;max-width:100%;height:20px;z-index:10;color:antiquewhite;background-color:rgba(0,0,0,0.5);top:1rem;text-align:center}.ImageViewer__overlayTop___2AckZ{top:0;left:95%;text-align:center}.ImageViewer__overlayRight___2JUTP{left:85%;text-align:center}.ImageViewer__hide___1aBrC{display:none}.ImageViewer__overlayLeft___38-fE{left:1%;text-align:left}.ImageViewer__imgContainer___3vJ9G{position:relative}.ImageViewer__imgContainer___3vJ9G:-ms-fullscreen>.ImageViewer__overlay___jS0Z0{display:inherit;top:2%}.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen>.ImageViewer__overlay___jS0Z0{display:inherit;top:2%}.ImageViewer__imgContainer___3vJ9G:-moz-full-screen>.ImageViewer__overlay___jS0Z0{display:inherit;top:2%}img.ImageViewer__active___1FrCT{max-height:100%;margin-left:auto;margin-right:auto;height:auto;max-width:100%;-webkit-transition-property:-webkit-transform;transition-property:transform, -webkit-transform;-webkit-transition-duration:0.2s;-o-transition-duration:0.2s;transition-duration:0.2s;-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.ImageViewer__imgContainer___3vJ9G:-ms-fullscreen>.ImageViewer__active___1FrCT{width:auto;max-height:100%}.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen{width:100%;height:100%;background-color:black}.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen>.ImageViewer__active___1FrCT{width:auto}.ImageViewer__imgContainer___3vJ9G:-moz-full-screen>.ImageViewer__active___1FrCT{width:auto;max-height:100%}.ImageViewer__modalContainer___1MxZ7{position:absolute;height:100px;width:95%}.ImageViewer__tag___2mHoz{background-color:rgba(0,0,0,0.5);display:table}.ImageViewer__HotKeys___2ICLN:focus{outline:0}.ImageViewer__centerText___1e3gu{text-align:center}\n",""]),t.locals={inlineBlock:"ImageViewer__inlineBlock___3x7PU",overlay:"ImageViewer__overlay___jS0Z0",overlayTop:"ImageViewer__overlayTop___2AckZ",overlayRight:"ImageViewer__overlayRight___2JUTP",hide:"ImageViewer__hide___1aBrC",overlayLeft:"ImageViewer__overlayLeft___38-fE",imgContainer:"ImageViewer__imgContainer___3vJ9G",active:"ImageViewer__active___1FrCT",modalContainer:"ImageViewer__modalContainer___1MxZ7",tag:"ImageViewer__tag___2mHoz",HotKeys:"ImageViewer__HotKeys___2ICLN",centerText:"ImageViewer__centerText___1e3gu"},e.exports=t},7:function(e,t,a){var i=a(13),o=a(73);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(i(o,r),o.locals?o.locals:{});e.exports=s},71:function(e,t,a){(t=a(14)(!1)).push([e.i,".Archive__container___3L_dg{margin:0 auto;padding:0;text-align:center}\n",""]),t.locals={container:"Archive__container___3L_dg"},e.exports=t},72:function(e,t,a){(t=a(14)(!1)).push([e.i,".Help__verticalCenter___2hUR-{-ms-flex-align:center;align-items:center}.Help__flex___2JJlN{display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap;list-style:none;background:rgba(0,0,0,0.9)}.Help__flex___2JJlN>*{-ms-flex:0 1 auto;flex:0 1 auto;max-width:100%;text-align:start}.Help__grow___4mrVI{-ms-flex-positive:1;flex-grow:1;color:#b8b5c0}.Help__noGrow___34bmx{-ms-flex-positive:0;flex-grow:0;color:lightblue}.Help__fullWidth___T7Iuq{width:100%}\n",""]),t.locals={verticalCenter:"Help__verticalCenter___2hUR-",flex:"Help__flex___2JJlN",grow:"Help__grow___4mrVI",noGrow:"Help__noGrow___34bmx",fullWidth:"Help__fullWidth___T7Iuq"},e.exports=t},73:function(e,t,a){(t=a(14)(!1)).push([e.i,".ArchiveCover__gallery___2XNvD{display:inline-block;vertical-align:top;text-align:center;background:#001a4c;font-weight:bold;position:relative;width:100%;border:1px solid grey;border-radius:2px}.ArchiveCover__gallery___2XNvD,a:hover{color:inherit;text-decoration:none}.ArchiveCover__coverTitle___3MvdX{max-height:28px;line-height:13px;padding:3px;overflow:hidden;width:100%;height:4em;font-size:0.85em}.ArchiveCover__extracted___2UiVm>a>.ArchiveCover__coverTitle___3MvdX{color:#00d0ff}.ArchiveCover__caption___1jseu{max-height:35px;line-height:15px;padding:3px;overflow:hidden;width:100%;z-index:10;font-size:0.85em;color:#a8a8a4}.ArchiveCover__imageContainer___C1fJ3{display:block;max-width:100%;height:auto;margin-left:auto;margin-right:auto}.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU{background:rgba(0,0,0,0.75);position:absolute;bottom:0;top:0;left:0;right:0;margin-top:28px;margin-bottom:21px;height:auto;width:100%;pointer-events:none;opacity:0;-webkit-transition:opacity 0.125s ease;-o-transition:opacity 0.125s ease;transition:opacity 0.125s ease}.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno{width:100%;height:100%;font-size:14px;font-weight:300;line-height:1.05;opacity:0;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;-webkit-transition:margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s;-o-transition:margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s;transition:margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s}.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno .ArchiveCover__tag___jOY9w{width:100%;cursor:pointer}.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU{opacity:1;pointer-events:all}.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno{opacity:1}.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU .ArchiveCover__ListToggle___3cs9R{opacity:1}.ArchiveCover__queryTag___3IBHh{color:lightgreen}.ArchiveCover__smallButton___2ZAiq{margin:2px}\n",""]),t.locals={gallery:"ArchiveCover__gallery___2XNvD",coverTitle:"ArchiveCover__coverTitle___3MvdX",extracted:"ArchiveCover__extracted___2UiVm",caption:"ArchiveCover__caption___1jseu",imageContainer:"ArchiveCover__imageContainer___C1fJ3",overlay:"ArchiveCover__overlay___1wIAU",tags:"ArchiveCover__tags___GLbno",tag:"ArchiveCover__tag___jOY9w",ListToggle:"ArchiveCover__ListToggle___3cs9R",queryTag:"ArchiveCover__queryTag___3IBHh",smallButton:"ArchiveCover__smallButton___2ZAiq"},e.exports=t},74:function(e,t,a){(t=a(14)(!1)).push([e.i,"@media screen and (min-width: 1456px){.SidebarArchives__archCont___30IUp{width:12%}}@media screen and (max-width: 1455px){.SidebarArchives__archCont___30IUp{width:19%}}@media screen and (max-width: 1019px){.SidebarArchives__archCont___30IUp{width:24%}}@media screen and (max-width: 814px){.SidebarArchives__archCont___30IUp{width:32%}}@media screen and (max-width: 542px){.SidebarArchives__archCont___30IUp{width:49%}}@media screen and (max-width: 300px){.SidebarArchives__archCont___30IUp{width:100%}}\n",""]),t.locals={archCont:"SidebarArchives__archCont___30IUp"},e.exports=t},75:function(e,t,a){(t=a(14)(!1)).push([e.i,".Home__inlineBlock___33Dcx{display:inline-block;width:55px}.Home__container___KkeO7{position:relative}.Home__overlay___1L6jf{position:absolute;max-width:100%;height:20px;z-index:10;color:antiquewhite;background-color:rgba(0,0,0,0.5);top:1rem;text-align:center}.Home__overlayTop___1g6qW{top:0;left:95%;text-align:center}.Home__overlayHelp___1USgm{position:absolute;left:85%}.Home__overlayRight___AiZmH{position:absolute;right:1%;top:0;z-index:5}.Home__overlayLeft___JWQEH{position:absolute;left:1%;z-index:5}.Home__imgContainer___3M7tW{position:relative}.Home__imgContainer___3M7tW:-ms-fullscreen>.Home__overlay___1L6jf{display:inherit;top:2%}.Home__imgContainer___3M7tW:-webkit-full-screen>.Home__overlay___1L6jf{display:inherit;top:2%}.Home__imgContainer___3M7tW:-moz-full-screen>.Home__overlay___1L6jf{display:inherit;top:2%}img.Home__active___2X6FD{max-height:100%;margin-left:auto;margin-right:auto;height:auto;max-width:100%}.Home__imgContainer___3M7tW:-ms-fullscreen>.Home__active___2X6FD{width:auto;max-height:100%}.Home__imgContainer___3M7tW:-webkit-full-screen{width:100%;max-height:100%;background-color:black}.Home__imgContainer___3M7tW:-webkit-full-screen>.Home__active___2X6FD{max-height:100%}.Home__imgContainer___3M7tW:-moz-full-screen>.Home__active___2X6FD{width:auto;max-height:100%}.Home__modalContainer___DzRT5{position:absolute;height:100px;width:95%}.Home__tag___30qLH{background-color:rgba(0,0,0,0.5);display:table}.Home__HotKeys___3qY1w:focus{outline:0}\n",""]),t.locals={inlineBlock:"Home__inlineBlock___33Dcx",container:"Home__container___KkeO7",overlay:"Home__overlay___1L6jf",overlayTop:"Home__overlayTop___1g6qW",overlayHelp:"Home__overlayHelp___1USgm",overlayRight:"Home__overlayRight___AiZmH",overlayLeft:"Home__overlayLeft___JWQEH",imgContainer:"Home__imgContainer___3M7tW",active:"Home__active___2X6FD",modalContainer:"Home__modalContainer___DzRT5",tag:"Home__tag___30qLH",HotKeys:"Home__HotKeys___3qY1w"},e.exports=t},76:function(e,t,a){"use strict";a.r(t);var i=a(0),o=a.n(i),r=a(10),s=a.n(r),n=(a(44),a(45),a(17)),l=a(12),c=a(19),h=a(2),_=a.n(h),d=a(32),g=a.n(d),m=a(20),u=a(15),p=a.n(u),v=a(77),y=a(78),f=a(79),C=a(33),w=a.n(C);var b=({className:e,currentPosition:t,lastPosition:a,navSelectOptions:i,handleChange:r,moveLeft:s,moveFirst:n,moveRight:l,moveLast:c})=>o.a.createElement(v.a,{listClassName:"justify-content-center my-0"},o.a.createElement(y.a,null,o.a.createElement(f.a,{onClick:n},"\u2190\u2190")),o.a.createElement(y.a,null,o.a.createElement(f.a,{onClick:s},"\u2190")),o.a.createElement(y.a,null,o.a.createElement("div",{className:w.a.midItem},o.a.createElement(m.a,{className:e,name:"select-page",value:{value:t,label:t},onChange:r,options:i,isClearable:!1,blurInputOnSelect:!0,noOptionsMessage:()=>"No valid option"}),o.a.createElement("span",{style:{verticalAlign:"super"}},` of ${a} `))),o.a.createElement(y.a,null,o.a.createElement(f.a,{onClick:l},"\u2192")),o.a.createElement(y.a,null,o.a.createElement(f.a,{onClick:c},"\u2192\u2192"))),I=a(80);var P=({images:e})=>o.a.createElement("div",{style:{position:"absolute",left:"85%",top:"16%",width:"15%"}},Object.keys(e).map(t=>{const a=e[Number(t)].percent;switch(e[Number(t)].state){case"progress":return o.a.createElement(I.a,{key:t,color:a<0?"warning":"success",value:a},`${t}: ${a}%`);case"load":return o.a.createElement(I.a,{key:t,color:"info",value:a},`${t}: ${a}%`);case"error":case"abort":return o.a.createElement(I.a,{key:t,color:"danger",value:a},`${t}: ${a}%`);default:return o.a.createElement(I.a,{key:t,color:"info",value:a},`${t}: ${a}%`)}})),x=a(4),k=a.n(x),E=a(34),S=a.n(E);const H={basename:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PB_HOST_URL||"/new-image-viewer",PandaBackupUrl:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PB_SERVER||"/r-api",PandaBackupKey:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PB_KEY||""};async function A(e,t){const a=t||1;let i;i=""===H.PandaBackupKey?"":`&api_key=${H.PandaBackupKey}`;const o=`${H.PandaBackupUrl}/archive/${e}/?position=${a}${i}`,r=await fetch(o,{credentials:"include"});return await r.json()}async function N(e){let t;t=""===e?`?api_key=${H.PandaBackupKey}`:`&api_key=${H.PandaBackupKey}`;const a=`${H.PandaBackupUrl}/archives/${e}${t}`,i=await fetch(a,{credentials:"include"});return await i.json()}function M(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function T(e,t,a,i){let o=e-i,r=e+i;return o<t&&(o=t),r>a&&(r=a),[new Array(e-o).fill(0).map((t,a)=>e-a-1),new Array(r-e).fill(0).map((t,a)=>a+e+1)]}function O(e,t){const a=t[0].length+t[1].length,i=[];for(let o=0;o<a;o++)for(let e=0;e<2;e++)t[e].length-1<o||i.push(t[e][o]);return[e,...i]}function L(e,t,a,i,o){let r=0,s=0;return a?e>=i?(r=i,s=r*t/e):(r=e,s=t):e>=o?(r=o,s=r*t/e):(r=e,s=t),[r,s]}const D={moveLeft:["left","a"],moveRight:["right","d"],moveFirst:"shift+left",moveLast:"shift+right",previousQueue:"y",nextQueue:"i",togglePositionModal:"u"};class F extends i.Component{constructor(e){super(e),M(this,"node",void 0),M(this,"imgContainer",void 0),M(this,"modalInput",void 0),M(this,"slider",void 0),M(this,"state",void 0),M(this,"props",void 0),M(this,"updateProgress",e=>{e.lengthComputable?this.setState({images:p()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{percent:e.loaded/e.total}}})}):this.setState({images:p()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{percent:-1}}})})}),M(this,"transferComplete",e=>{this.setState({images:p()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{percent:100,state:"load"}}})})}),M(this,"transferFailed",e=>{this.setState({images:p()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{state:"error"}}})})}),M(this,"transferCanceled",e=>{this.setState({images:p()(this.state.images,{[Number(e.currentTarget.id)]:{$merge:{state:"abort"}}})})}),M(this,"getImagesData",e=>{e.filter(e=>!{}.hasOwnProperty.call(this.state.images,e.position)).forEach(e=>{const t=new window.Image;t.id=e.position.toString(),t.addEventListener("progress",this.updateProgress),t.addEventListener("load",this.transferComplete),t.addEventListener("error",this.transferFailed),t.addEventListener("abort",this.transferCanceled),t.src=e.url,this.setState({images:p()(this.state.images,{[e.position]:{$set:{position:e.position,url:e.url,width:e.width,height:e.height,is_horizontal:e.is_horizontal,state:"progress",percent:0}}})})})}),M(this,"getNonCachedImagesUrls",(e,t)=>{const a=t.filter(e=>!{}.hasOwnProperty.call(this.state.images,e));0!==a.length&&async function(e,t){const a=S.a.stringify({i:t},{indices:!1});let i;i=""===H.PandaBackupKey?"":`&api_key=${H.PandaBackupKey}`;const o=`${H.PandaBackupUrl}/archive/${e}/image_list/?${a}${i}`,r=await fetch(o,{credentials:"include"});return await r.json()}(e,a).then(e=>this.getImagesData(e))}),M(this,"goToPosition",e=>{e!==this.state.currentPosition&&this.props.history.replace(`/${this.props.archive.id}/img/${e}${this.props.location.search}`)}),M(this,"handleImgClick",e=>{!function(e){const t=e.currentTarget;let a=0,i=t;for(;i;)a+=i.offsetLeft,i=i.offsetParent;return t.style.paddingLeft&&(a+=Number(t.style.paddingLeft.match(/\d+/)[0])),a-=window.scrollX,(e.clientX-a)/(t.width||t.offsetWidth)>.5}(e)?this.moveLeft():this.moveRight()}),M(this,"handleSliderChange",e=>{this.goToPosition(e+1)}),M(this,"moveLeft",()=>{this.props.doublePageMode&&this.state.navImages[0].length>1?this.handlePositionChanges(this.state.navImages[0][1]):this.state.navImages[0].length>0&&this.handlePositionChanges(this.state.navImages[0][0])}),M(this,"moveRight",()=>{this.props.doublePageMode&&this.state.navImages[1].length>1?this.handlePositionChanges(this.state.navImages[1][1]):this.state.navImages[1].length>0&&this.handlePositionChanges(this.state.navImages[1][0])}),M(this,"moveFirst",()=>{this.handlePositionChanges(this.props.startPosition)}),M(this,"moveLast",()=>{this.handlePositionChanges(this.props.archive.lastPosition)}),M(this,"handlePositionModalGoTo",e=>{this.handlePositionChanges(e.value)}),M(this,"handlePositionChanges",e=>{this.goToPosition(e),this.props.displayCovers&&this.slider.slickGoTo(e-1)}),M(this,"togglePositionModal",()=>{this.setState({showPositionModal:!this.state.showPositionModal}),this.state.showPositionModal&&this.modalInput&&this.modalInput.current&&this.modalInput.current.focus(),!this.state.showPositionModal&&this.modalInput&&this.modalInput.current&&this.modalInput.current.blur()}),M(this,"correctWith",e=>e.is_horizontal?e.width>=this.state.horizontal?this.state.horizontal:e.width:e.width>=this.state.vertical?this.state.vertical:e.width),M(this,"getDisplayImage",(e,t,a)=>o.a.createElement("img",{key:e.url,className:k.a.active,src:e.url,alt:"",width:t?"auto":this.correctWith(e),height:e.height,style:a})),M(this,"keyHandlers",{moveLeft:this.moveLeft,moveRight:this.moveRight,moveFirst:this.moveFirst,moveLast:this.moveLast,previousQueue:()=>this.props.handleQueueChange(this.props.archive.id,-1),nextQueue:()=>this.props.handleQueueChange(this.props.archive.id,1),togglePositionModal:e=>{this.togglePositionModal(),e.preventDefault()}}),this.modalInput=o.a.createRef();const t={};if(e.archive.startImage){const[a,i]=L(e.archive.startImage.width,e.archive.startImage.height,e.archive.startImage.is_horizontal,1500,900);e.archive.startImage&&(t[e.startIndex]={position:e.startIndex,url:e.archive.startImage.url,width:a,height:i,is_horizontal:e.archive.startImage.is_horizontal,state:"load",percent:100})}this.state={currentArchiveId:e.archive.id,currentPosition:e.startIndex,positionModal:e.startIndex,horizontal:1500,vertical:900,showPositionModal:!1,loading:!0,navImages:T(e.startIndex,e.startPosition,e.archive.lastPosition,e.preloadCount),images:t}}componentDidMount(){this.getNonCachedImagesUrls(this.props.archive.id,O(this.state.currentPosition,[this.state.navImages[1],this.state.navImages[0]])),this.node&&this.node.scrollIntoView(),this.props.displayCovers&&this.slider.slickGoTo(this.state.currentPosition-1),this.props.setCurrentContainer(this.imgContainer)}static getDerivedStateFromProps(e,t){const a=e.archive.id,i=t.currentArchiveId,o=e.startIndex,r=t.currentPosition;if(a!==i){const i={};if(e.archive.startImage){const[a,o]=L(e.archive.startImage.width,e.archive.startImage.height,e.archive.startImage.is_horizontal,t.horizontal,t.vertical);e.archive.startImage&&(i[e.startIndex]={position:e.startIndex,url:e.archive.startImage.url,width:a,height:o,is_horizontal:e.archive.startImage.is_horizontal,state:"load",percent:100})}return{currentArchiveId:a,currentPosition:e.startIndex,positionModal:e.startIndex,loading:!0,navImages:T(e.startIndex,e.startPosition,e.archive.lastPosition,e.preloadCount),images:i}}return o!==r?{loading:!0,navImages:T(o,e.startPosition,e.archive.lastPosition,e.preloadCount),currentPosition:o,positionModal:o}:null}componentDidUpdate(e){const t=this.props.archive.id,a=e.archive.id,i=this.props.startIndex,o=e.startIndex;t!==a||i!==o?(this.getNonCachedImagesUrls(t,O(this.state.currentPosition,[this.state.navImages[1],this.state.navImages[0]])),this.imgContainer&&this.imgContainer.scrollIntoView()):this.props.displayAllPreloaded!=e.displayAllPreloaded&&this.imgContainer&&this.imgContainer.scrollIntoView(),this.props.displayCovers&&this.slider.slickGoTo(this.state.currentPosition-1)}componentWillUnmount(){this.props.setCurrentContainer(null)}render(){const{showPositionModal:e,currentPosition:t,images:a,navImages:i}=this.state,{displayCovers:r,displayNavigators:s,displayMetadata:n,autoWidth:l,displayPreloadInfo:h,doublePageMode:d,displayAllPreloaded:u,scale:p}=this.props,{lastPosition:v}=this.props.archive,y=n&&o.a.createElement("div",{className:_()(k.a.overlay,k.a.overlayLeft)},o.a.createElement("div",{className:k.a.tag},this.props.archive.title),this.props.archive.tags.map(e=>o.a.createElement("div",{className:k.a.tag,key:e},`${e}`))),f={transform:`scaleX(${p}) scaleY(${p})`,transformOrigin:"center top"},C=[];let w=[],I=[];u&&(w=i[0].filter(e=>void 0!==a[e]).reverse().map(e=>o.a.createElement("div",{key:e},this.getDisplayImage(a[e],l,f))),I=i[1].filter(e=>void 0!==a[e]&&(!d||e!=t+1)).map(e=>o.a.createElement("div",{key:e},this.getDisplayImage(a[e],l,f)))),d&&t<v&&a[t+1]&&C.push(this.getDisplayImage(a[t+1],l,f)),a[t]&&C.push(this.getDisplayImage(a[t],l,f));const x=r&&new Array(v).fill(0).map((e,t)=>!{}.hasOwnProperty.call(a,t+1)?o.a.createElement("div",{key:String(t+1),style:{width:210,height:285}},o.a.createElement("h3",null,"Not loaded")):o.a.createElement("div",{key:a[t+1].url,style:{width:210,height:285}},o.a.createElement("img",{className:"img-fluid mx-auto",src:a[t+1].url,alt:"",width:200,height:"auto"}))),E=new Array(v).fill(0).map((e,t)=>({value:t+1,label:t+1})),S=e&&o.a.createElement("div",{className:k.a.modalContainer},o.a.createElement(m.a,{className:k.a.inlineBlock,name:"select-page-fast",value:{value:t,label:t},onChange:this.handlePositionModalGoTo,options:E,clearable:!1,autoBlur:!0,openOnFocus:!0,onClose:this.togglePositionModal,noResultsText:"No valid page",ref:this.modalInput})),H=h&&o.a.createElement(P,{images:a});return o.a.createElement(c.GlobalHotKeys,{className:k.a.HotKeys,keyMap:D,handlers:this.keyHandlers},o.a.createElement("div",{ref:e=>this.node=e},o.a.createElement("h6",null,this.props.archive.title),r&&o.a.createElement(g.a,{dots:!1,infinite:!1,speed:0,slidesToShow:3,slidesToScroll:1,focusOnSelect:!0,centerMode:!0,centerPadding:"0",ref:e=>{this.slider=e},variableWidth:!0,initialSlide:this.props.startIndex-1,afterChange:this.handleSliderChange},x),s&&o.a.createElement(b,{className:k.a.inlineBlock,currentPosition:t,lastPosition:v,moveFirst:this.moveFirst,moveLeft:this.moveLeft,moveRight:this.moveRight,moveLast:this.moveLast,handleChange:this.handlePositionModalGoTo,navSelectOptions:E}),H,w?o.a.createElement("div",{id:"img-previous",className:k.a.imgContainer},w):null,o.a.createElement("div",{id:"img-display",className:k.a.imgContainer,onClick:this.handleImgClick,ref:e=>this.imgContainer=e},S,a[t]?C:o.a.createElement("h5",null,"Archive needs to be extracted before using it in here."),o.a.createElement("div",{className:_()(k.a.overlay,k.a.overlayTop,k.a.hide)},o.a.createElement("span",{id:"img-counter"},t),"/",v),y),I?o.a.createElement("div",{id:"img-next",className:k.a.imgContainer},I):null))}}var j=Object(l.e)(F),R=a(37),V=a.n(R);class $ extends i.Component{constructor(...e){var t,a,i;super(...e),i={archive:null},(a="state")in(t=this)?Object.defineProperty(t,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[a]=i}componentDidMount(){A(this.props.match.params.archiveId,Number(this.props.match.params.imgId)).then(e=>{this.setState({archive:e}),document.title=e.title})}componentDidUpdate(e){const t=e.match.params.archiveId,a=this.props.match.params.archiveId,i=this.props.match.params.imgId;a!==t&&A(a,Number(i)).then(e=>{this.setState({archive:e}),document.title=e.title})}render(){const{archive:e}=this.state,{match:t,handleQueueChange:a,displayCovers:i,displayNavigators:r,displayMetadata:s,autoWidth:n,displayPreloadInfo:l,doublePageMode:c,setCurrentContainer:h,scale:_,preloadCount:d,displayAllPreloaded:g}=this.props;return o.a.createElement("div",{className:V.a.container},e?o.a.createElement(j,{startIndex:Number(t.params.imgId),archive:e,startPosition:1,handleQueueChange:a,displayCovers:i,displayNavigators:r,displayMetadata:s,displayPreloadInfo:l,doublePageMode:c,displayAllPreloaded:g,setCurrentContainer:h,autoWidth:n,scale:_,preloadCount:d}):null)}}var U=$,z=a(11),W=a.n(z);var K=({actions:e})=>o.a.createElement("div",{className:W.a.flex},o.a.createElement("div",{className:_()(W.a.verticalCenter,W.a.fullWidth)},"Keyboard shortcuts"),e.map(e=>o.a.createElement("div",{className:_()(W.a.verticalCenter,W.a.flex,W.a.fullWidth),key:e.key},o.a.createElement("div",{className:_()(W.a.grow)},e.description),o.a.createElement("div",{className:_()(W.a.noGrow)},e.key)))),B=a(7),q=a.n(B);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function G(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){J(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function J(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const X=({src:e,title:t,height:a,width:i,className:r})=>{const s={maxHeight:290,width:i},n={height:"auto",maxWidth:"100%",maxHeight:a,border:"1px solid #ccc"};return o.a.createElement("div",{className:r,style:G({},s)},o.a.createElement("img",{style:n,src:e,alt:t,height:a,width:i}))};X.defaultProps={width:200,height:290};var Z=X,Y=a.p+"static/media/no_cover.8e25d57e.png";var ee=Object(l.e)(({archive:e,location:t})=>{const a=e.image?e.image:Y,i=e.tags.map(e=>o.a.createElement("div",{className:q.a.tag,key:e},`${e}`));return o.a.createElement("div",{className:_()(q.a.gallery,e.extracted?q.a.extracted:null)},o.a.createElement(n.b,{to:`/${e.id}/img/1${t.search}`},o.a.createElement("div",{className:q.a.coverTitle,title:e.title},e.title),o.a.createElement(Z,{className:q.a.imageContainer,src:a,title:e.title,width:e.image_width,height:e.image_height}),o.a.createElement("div",{className:q.a.overlay},o.a.createElement("div",{className:q.a.tags},i))),o.a.createElement("div",null,o.a.createElement("div",{className:q.a.caption},`${e.filecount} | `,o.a.createElement("a",{className:_()(q.a.link,q.a.highlight),href:`${e.url}`},"SRC"))))}),te=a(81);const ae={position:"absolute",top:"0px"};var ie=({onClick:e,showContent:t,alignRight:a})=>{let i;const r=a?">":"<",s=a?"<":">";return i=t?Object.assign({},ae,a?{left:"-30px"}:{right:"-30px"}):Object.assign({},ae,a?{right:"0"}:{left:"0"}),o.a.createElement(te.a,{onClick:e,size:"sm",style:i},t?r:s)},oe=a(38),re=a.n(oe);var se=({displayQueue:e,archives:t,toggleQueue:a,className:i})=>o.a.createElement("div",{className:_()(i,e?re.a.archCont:null)},e?t.objects.map(e=>o.a.createElement("div",{key:e.id},o.a.createElement(ee,{archive:e}))):null,o.a.createElement(ie,{onClick:a,showContent:e,alignRight:!1}));var ne=({displayControls:e,toggleControls:t,className:a,controls:i})=>o.a.createElement("div",{className:a},o.a.createElement("div",null,e?i.map(e=>o.a.createElement("div",{key:e.key},o.a.createElement(te.a,{onClick:e.action,color:"primary",size:"sm",block:!0},e.description))):null,o.a.createElement(ie,{onClick:t,showContent:e,alignRight:!0}))),le=a(16),ce=a.n(le);function he(){return(he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function _e(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class de extends i.Component{constructor(e){super(e),_e(this,"state",{archives:null,displayQueue:!1,displayHelp:!1,displayControls:!1,currentArchive:null,displayCovers:!1,displayNavigators:!0,displayMetadata:!1,displayPreloadInfo:!1,doublePageMode:!1,autoWidth:!1,scale:1,preloadCount:5,currentContainer:null,displayAllPreloaded:!1}),_e(this,"_HotKeysContainer",void 0),_e(this,"toggleFullSize",()=>{this.setState({autoWidth:!this.state.autoWidth})}),_e(this,"toggleMetadata",()=>{this.setState({displayMetadata:!this.state.displayMetadata})}),_e(this,"toggleDoublePageMode",()=>{this.setState({doublePageMode:!this.state.doublePageMode})}),_e(this,"decreaseScale",()=>{this.setState({scale:this.state.scale-.1})}),_e(this,"increaseScale",()=>{this.setState({scale:this.state.scale+.1})}),_e(this,"resetScale",()=>{this.setState({scale:1})}),_e(this,"togglePreloadInfo",()=>{this.setState({displayPreloadInfo:!this.state.displayPreloadInfo})}),_e(this,"toggleHelp",()=>{this.setState({displayHelp:!this.state.displayHelp})}),_e(this,"toggleCovers",()=>{this.setState({displayCovers:!this.state.displayCovers})}),_e(this,"toggleQueue",()=>{this.setState({displayQueue:!this.state.displayQueue})}),_e(this,"togglePreloadCount",()=>{this.setState({preloadCount:5==this.state.preloadCount?1:5})}),_e(this,"toggleControls",()=>{this.setState({displayControls:!this.state.displayControls})}),_e(this,"setCurrentContainer",e=>{this.setState({currentContainer:e})}),_e(this,"contentFullScreen",()=>{if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this.state.currentContainer;e&&(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())}}),_e(this,"toggleAllPreloaded",()=>{this.setState({displayAllPreloaded:!this.state.displayAllPreloaded})}),_e(this,"actions",[{key:"left, a",name:"moveLeft",description:"Move Left"},{key:"right, d, space",name:"moveRight",description:"Move Right"},{key:"shift+left",name:"moveFirst",description:"Move First"},{key:"shift+right",name:"moveLast",description:"Move Last"},{key:"y",name:"previousQueue",description:"Previous in queue"},{key:"i",name:"nextQueue",description:"Next in queue"},{key:"h",name:"toggleHelp",description:"Toggle help"},{key:"p",name:"toggleQueue",description:"Toggle queue"},{key:"l",name:"toggleControls",description:"Toggle controls"},{key:"-",name:"decreaseScale",description:"Decrease Scale",action:this.decreaseScale},{key:"+",name:"increaseScale",description:"Increase Scale",action:this.increaseScale},{key:"=",name:"resetScale",description:"Reset Scale",action:this.resetScale},{key:"g",name:"toggleFullSize",description:"Full Size",action:this.toggleFullSize},{key:"f",name:"toggleFullScreen",description:"Full Screen",action:this.contentFullScreen},{key:"o",name:"toggleAllPreloaded",description:"Display all preloaded",action:this.toggleAllPreloaded},{key:"c",name:"toggleCovers",description:"Covers"},{key:"t",name:"toggleDoublePageMode",description:"Double page mode",action:this.toggleDoublePageMode},{key:"u",name:"togglePositionModal",description:"Position Modal"},{key:"j",name:"toggleMetadata",description:"Metadata",action:this.toggleMetadata},{key:"shift+p",name:"togglePreloadCount",description:"Preload Count",action:this.togglePreloadCount},{key:"shift+j",name:"togglePreloadInfo",description:"Preload Info",action:this.togglePreloadInfo}]),_e(this,"keyHandlers",{togglePreloadInfo:this.togglePreloadInfo,decreaseScale:this.decreaseScale,increaseScale:this.increaseScale,resetScale:this.resetScale,toggleFullSize:this.toggleFullSize,toggleCovers:this.toggleCovers,toggleDoublePageMode:this.toggleDoublePageMode,toggleHelp:this.toggleHelp,toggleMetadata:this.toggleMetadata,toggleQueue:this.toggleQueue,toggleControls:this.toggleControls,toggleFullScreen:this.contentFullScreen,togglePreloadCount:this.togglePreloadCount,toggleAllPreloaded:this.toggleAllPreloaded}),_e(this,"handleQueueChange",(e,t)=>{if(this.state.archives){const a=this.state.archives.objects.findIndex(t=>t.id===e);if(a>-1&&this.state.archives){const e=a+t;e>=0&&e<this.state.archives.objects.length&&this.props.history.push(`/${this.state.archives.objects[e].id}/img/1${this.props.location.search}`)}}}),this._HotKeysContainer=o.a.createRef()}componentDidMount(){this._HotKeysContainer&&this._HotKeysContainer.current&&this._HotKeysContainer.current.focus(),N(this.props.location.search).then(e=>{this.setState({archives:e})})}componentDidUpdate(e){const t=e.location.search,a=this.props.location.search;a!==t&&N(a).then(e=>{this.setState({archives:e})})}componentWillUnmount(){}render(){const{archives:e,displayQueue:t,displayHelp:a,displayCovers:i,displayNavigators:r,displayMetadata:s,autoWidth:n,displayPreloadInfo:h,doublePageMode:d,displayControls:g,scale:m,preloadCount:u,displayAllPreloaded:p}=this.state,{match:v}=this.props;return o.a.createElement(c.HotKeys,{className:ce.a.HotKeys,innerRef:this._HotKeysContainer,keyMap:this.actions.filter(e=>this.keyHandlers.hasOwnProperty(e.name)).reduce((e,t)=>(e[t.name]=t.key,e),{}),handlers:this.keyHandlers},o.a.createElement("div",null,o.a.createElement("div",{className:ce.a.container},e?o.a.createElement(se,{className:ce.a.overlayLeft,archives:e,displayQueue:t,toggleQueue:this.toggleQueue}):null,o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(l.a,{path:`${v.url}:archiveId/img/:imgId`,render:e=>o.a.createElement(U,he({handleQueueChange:this.handleQueueChange,displayCovers:i,displayNavigators:r,displayMetadata:s,displayPreloadInfo:h,displayAllPreloaded:p,doublePageMode:d,setCurrentContainer:this.setCurrentContainer,autoWidth:n,scale:m,preloadCount:u},e))})),a&&o.a.createElement("div",{className:_()(ce.a.overlay,ce.a.overlayHelp)},o.a.createElement(K,{actions:this.actions})),o.a.createElement(ne,{className:ce.a.overlayRight,displayControls:g,toggleControls:this.toggleControls,controls:this.actions.filter(e=>void 0!==e.action)}))))}}var ge=Object(l.e)(de);var me=()=>o.a.createElement(o.a.StrictMode,null,o.a.createElement(n.a,{basename:H.basename},o.a.createElement(l.a,{path:"/",component:ge})));const ue=document.getElementById("root");null!==ue&&s.a.render(o.a.createElement(me,null),ue)}},[[39,1,2]]]);
//# sourceMappingURL=main.9c213543.chunk.js.map